<!DOCTYPE html>
<html lang="zh"><meta charset="utf-8"><meta name="generator" content="Hugo 0.83.1" /><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<meta name="color-scheme" content="light dark">
<meta name="supported-color-schemes" content="light dark"><title>在 ubuntu服务器上安装Clash &nbsp;&ndash;&nbsp;蜀山小筑</title><link rel="stylesheet" href="/css/core.min.2b84579068bd8ec3d1cd26c1d4177c5a85fee2eba66d7cd5aa289e9b7aef0a612b119e4bc14d850c83d270f4b192374c.css" integrity="sha384-K4RXkGi9jsPRzSbB1Bd8WoX&#43;4uumbXzVqiiem3rvCmErEZ5LwU2FDIPScPSxkjdM"><meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="在 ubuntu服务器上安装Clash " /><body><section id="header">
    <div class="header wrap"><span class="header left-side"><a class="site home" href="/"><img class="site logo" src="/img/logo.png" alt /><span class="site name">蜀山小筑</span></a></span>
        <span class="header right-side"><div class="nav wrap"><nav class="nav"><a class="nav item" href="/">主页</a><a class="nav item" href="/tags">标签</a><a class="nav item" href="/categories">分类</a><a class="nav item" href="/about">关于我</a></nav></div></span></div><div class="site slogan"><span class="title">「少即多,慢则快」</span></div></section><section id="content"><div class="article-container"><section class="article header">
    <h1 class="article title">在 ubuntu服务器上安装Clash </h1><p class="article date">Monday, November 18, 2019</p></section><article class="article markdown-body"><h2 id="一前言">一、前言</h2>
<p>这是一个媲美 Surge 的代理客户端，免费、简洁的界面，支持 SS、V2Ray、SOCKS5 协议、支持规则分流和屏蔽广告（类似 Surge 的规则），支持托管订阅。</p>
<h2 id="二必要条件">二、必要条件</h2>
<h3 id="1-linux服务器一台">1. linux服务器一台</h3>
<h2 id="三安装clash到-linux-系统上">三、安装Clash到 Linux 系统上</h2>
<h3 id="1-下载并安装clash">1. 下载并安装Clash</h3>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">进入当前用户根目录
<span class="nb">cd</span> ~
<span class="c1">#下载二进制文件</span>
wget https://github.com/Dreamacro/clash/releases/download/v0.16.0/clash-linux-amd64-v0.16.0.gz 
<span class="c1">#使用 gzip 解压</span>
gzip -d clash-linux-amd64-v0.16.0.gz 
<span class="c1">#移动到bin</span>
mv clash-linux-amd64-v0.16.0 /usr/local/bin/clash 
<span class="c1">#添加执行权限</span>
chmod +x /usr/local/bin/clash 
</code></pre></div><h3 id="2配置clash启动服务">2.配置Clash启动服务</h3>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">nano /etc/systemd/system/clash.service
</code></pre></div><p>把下面的信息复制进去</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>Unit<span class="o">]</span>
<span class="nv">Description</span><span class="o">=</span>clash service
<span class="nv">After</span><span class="o">=</span>network.target

<span class="o">[</span>Service<span class="o">]</span>
<span class="nv">Type</span><span class="o">=</span>simple
<span class="nv">User</span><span class="o">=</span>root
<span class="nv">ExecStart</span><span class="o">=</span>/usr/local/bin/clash
<span class="nv">Restart</span><span class="o">=</span>on-failure <span class="c1"># or always, on-abort, etc</span>

<span class="o">[</span>Install<span class="o">]</span>
<span class="nv">WantedBy</span><span class="o">=</span>multi-user.target
</code></pre></div><h3 id="3设置-clash-开机自启">3.设置 Clash 开机自启</h3>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">systemctl daemon-reload
systemctl <span class="nb">enable</span> clash
</code></pre></div><pre><code>service clash start    # 启动    
service clash stop     # 停止  
service clash restart  # 重启  
service clash status   # 状态  

</code></pre><h3 id="4下载-dashboard-控制面板">4.下载 dashboard 控制面板</h3>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># 创建 .config目录</span>
mkdir .config 
<span class="c1"># 创建 clash 目录</span>
mkdir ~/.config/clash
<span class="c1"># 下载 dashboard</span>
wget https://github.com/haishanh/yacd/archive/gh-pages.zip
<span class="c1"># 用 unzip解压缩 </span>
unzip gh-pages.zip
<span class="c1"># 把文件改名层 dashboard</span>
mv yacd-gh-pages/ ~/.config/clash/dashboard/
</code></pre></div><h3 id="5配置-clash-文件">5.配置 Clash 文件</h3>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># 进入配置文件目录</span>
<span class="nb">cd</span> ~/.config/
<span class="c1"># 编辑 Clash 配置文件config.yaml</span>
nano config.yaml

</code></pre></div><pre><code>[去 GitHub 自己复制吧]&lt;https://github.com/ConnersHua/Profiles/edit/master/Clash/Pro.yaml&gt;
</code></pre><h3 id="6启动前">6.启动前</h3>
<p>配置文件里面的加密是重点</p>
<h3 id="7启动-clash">7.启动 Clash</h3>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">service clash start
</code></pre></div><h3 id="8tada-完成">8.:tada: 完成</h3>
<p>访问http://serverip:9090/ui/ 试试吧</p>
<h2 id="四通过v2ray访问已安装clash的服务器">四、通过V2ray访问已安装Clash的服务器</h2>
<p>v2ray配置如下</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">{</span>
  <span class="s2">&#34;inbounds&#34;</span>: <span class="o">[</span>
    <span class="o">{</span>
      <span class="s2">&#34;port&#34;</span>: 30123,
      <span class="s2">&#34;listen&#34;</span>:<span class="s2">&#34;127.0.0.1&#34;</span>, //只监听 127.0.0.1，避免除本机外的机器探测到开放了 <span class="m">30123</span> 端口
      <span class="s2">&#34;protocol&#34;</span>: <span class="s2">&#34;vmess&#34;</span>,
      <span class="s2">&#34;settings&#34;</span>: <span class="o">{</span>
        <span class="s2">&#34;clients&#34;</span>: <span class="o">[</span>
          <span class="o">{</span>
            <span class="s2">&#34;id&#34;</span>: <span class="s2">&#34;b831381d-6324-4d53-ad4f-8cda48b30811&#34;</span>,
            <span class="s2">&#34;alterId&#34;</span>: <span class="m">64</span>
          <span class="o">}</span>
        <span class="o">]</span>
      <span class="o">}</span>,
      <span class="s2">&#34;streamSettings&#34;</span>: <span class="o">{</span>
        <span class="s2">&#34;network&#34;</span>: <span class="s2">&#34;ws&#34;</span>,
        <span class="s2">&#34;wsSettings&#34;</span>: <span class="o">{</span>
        <span class="s2">&#34;path&#34;</span>: <span class="s2">&#34;/ray30123&#34;</span>
        <span class="o">}</span>
      <span class="o">}</span>
    <span class="o">}</span>
  <span class="o">]</span>,
  <span class="s2">&#34;outbounds&#34;</span>: <span class="o">[</span>
    <span class="o">{</span>
      <span class="s2">&#34;protocol&#34;</span>: <span class="s2">&#34;socks&#34;</span>,
      <span class="s2">&#34;settings&#34;</span>: <span class="o">{</span>
        <span class="s2">&#34;settings&#34;</span>: <span class="o">{</span>
        <span class="s2">&#34;servers&#34;</span>: <span class="o">[{</span>
        <span class="s2">&#34;address&#34;</span>: <span class="s2">&#34;127.0.0.1&#34;</span>,
        <span class="s2">&#34;port&#34;</span>: 7891,
        <span class="s2">&#34;auth&#34;</span>: <span class="s2">&#34;noauth&#34;</span>
      <span class="o">}]</span>
     <span class="o">}</span>
    <span class="o">}</span>
  <span class="o">]</span>
<span class="o">}</span>
</code></pre></div><h3 id="在线-json-编辑器httpjsoneditoronlineorg"><a href="http://jsoneditoronline.org/"target="_blank" rel="noopener noreferrer">在线 json 编辑器</a>
</h3>
<h2 id="五关闭端口">五、关闭端口</h2>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1">#打开端口</span>
iptables -A INPUT -p   <span class="nv">$port</span>   -j ACCEPT
<span class="c1">#关闭端口  </span>
iptables -A INPUT -p <span class="nv">$port</span>   -j DROP

</code></pre></div><hr>
<p>[参考1]<a href="https://breakertt.moe/2019/08/20/clash_gateway/index.html">https://breakertt.moe/2019/08/20/clash_gateway/index.html</a> <br>
[参考2]<a href="https://qust.me/post/678ffe99.html">https://qust.me/post/678ffe99.html</a></p>
</article><section class="article labels"><a class="tag" href=/tags/clash/>Clash</a></section><section class="article license">版权声明：如果转发请带上本文链接和注明来源。</section><section class="article author"><img class="avatar" src="/img/avatar.jpg" alt><p class="name">愚道</p><div class="bio">求知若渴，虚心若愚</div><div class="details"><a class="item" href="https://github.com/YALEAX" target="_blank" rel="noopener noreferrer"><span class="iconfont icon-github"></span>&nbsp;YALEAX</a><a class="item" href="mailto:Qu@JzE.us" target="_blank" rel="noopener noreferrer"><span class="iconfont icon-email"></span>&nbsp;Qu@JzE.us</a></div>
</section>
</div>
<div class="article bottom"><section class="article navigation"><p><a class="link" href="/post/%E4%BD%BF%E7%94%A8-certbot%E6%89%8B%E5%8A%A8%E8%8E%B7%E5%8F%96-lets-encrypt-%E5%85%8D%E8%B4%B9%E8%AF%81%E4%B9%A6caddy%E6%89%8B%E5%8A%A8%E9%85%8D%E7%BD%AE%E8%AF%81%E4%B9%A6/"><span class="iconfont icon-article"></span>使用 Certbot手动获取 Let's Encrypt 免费证书Caddy手动配置证书</a></p><p><a class="link" href="/post/ubuntu-18-04%E5%BF%AB%E9%80%9F%E5%BC%80%E5%90%AFgoogle-bbr/"><span class="iconfont icon-article"></span>Ubuntu 18.04快速开启Google BBR</a></p></section></div></section><section id="footer"><div class="footer-wrap">
    <p class="copyright">©2021 蜀山小筑.</p>
    <p class="powerby"><span>Powered&nbsp;by&nbsp;</span><a href="https://gohugo.io" 
        target="_blank" rel="noopener noreferrer">Hugo</a><span>&nbsp;&amp;&nbsp;</span><a href="https://themes.gohugo.io/hugo-notepadium/" 
        target="_blank" rel="noopener noreferrer">Notepadium</a></p></div>
</section><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/&#43;DiW/UqRcLbRjq" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l&#43;B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd&#43;qj&#43;o24G5ZU2zJz" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"
            onload="renderMathInElement(document.body);"></script></body>

</html>